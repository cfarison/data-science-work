---
title: "Traumatic Brain Injury Trends"
author: "Charlie Farison"
date: 2020-08-05
output:
  github_document:
    toc: true
---

*Purpose*: We'd like to understand trends in causes of traumatic brain injury.

# Background
<!-- -------------------------------------------------- -->

Brain Injury Awareness Month, observed each March, was established 3 decades ago to educate the public about the incidence of brain injury and the needs of persons with brain injuries and their families. Caused by a bump, blow, or jolt to the head, or penetrating head injury, a traumatic brain injury (TBI) can lead to short- or long-term changes affecting thinking, sensation, language, or emotion.

TBI is very common. One of every 60 people in the U.S. lives with a TBI related disability. Moderate and severe traumatic brain injury (TBI) can lead to a lifetime of physical, cognitive, emotional, and behavioral changes.

**Sources:**

- CDC: https://www.cdc.gov/mmwr/volumes/68/wr/mm6810a1.htm
- TidyTuesday: https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-03-24/readme.md

# Data Dictionaries
<!-- -------------------------------------------------- -->

**tbi_age**

| Variable | Class | Description |
|----------|----------------|--------------|
| age_group | character | Age group |
| type | character | Type of measure |
| injury_mechanism | character | Injury mechanism |
| number_est | double | Estimated observed cases in 2014 |
| rate_est | double | Rate/100,000 in 2014 |

**tbi_year**

| Variable | Class | Description |
|----------|----------------|--------------|
| injury_mechanism | character | Injury mechanism |
| type | character | Type of measure |
| year | character | Year (2006 - 2014) |
| rate_est | double | Rate/100,000 in 2014 |
| number_est | integer | Estimated observed cases in each year |

type has 3 possible values:

- Emergency Department Visit				
- Hospitalizations				
- Deaths

injury_mechanism has 7 possible values:

- Motor Vehicle Crashes			
- Unintentional Falls			
- Unintentionally struck by or against an object			
- Other unintentional injury, mechanism unspecified			
- Intentional self-harm			
- Assault			
- Other or no mechanism specified

# Data Background

- This data set comes from the CDC. 
- Because all of the TBIs in this dataset are recorded with type of either Emergency Department Visit, Hospitalization, or Deaths, I assume that only TBIs that result in one of these 3 outcomes are present in this data set. 
- Less severe TBIs that do not require Emergency Department Visit or Hospitalization and do not result in death are not reported.
- This data is likely aggregated from many different hospitals, so its completeness is uncertain.

# Data Ingestion
<!-- -------------------------------------------------- -->
```{r data_ingestion, include = FALSE}
tbi_age <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-24/tbi_age.csv')
tbi_year <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-24/tbi_year.csv')
tbi_military <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-24/tbi_military.csv')
```

# Findings
<!-- -------------------------------------------------- -->

*A Marked Increase*
- The traumatic brain injuries reported in this dataset increased dramatically from 2006 to 2014, primarily due to a nearly twofold increase in unintentional falls. (The dramatic increase came primarily from the following type...)

```{r tbis_by_year}
library(tidyverse)

tbi_summary <-
  tbi_year %>%
  mutate(year = as.integer(year)) %>%
  group_by(year, injury_mechanism) %>%
  summarize(total = sum(number_est)) %>%
  filter(total > 0) %>%
  mutate(total = total / 1000)

tbi_summary %>%
  ggplot(mapping = aes(x = year, y = total, color = injury_mechanism)) +
  geom_point() +
  geom_line() +
  scale_color_discrete(name = "Injury Mechanism") +
  labs(
    title = "Increase in TBIs from Unintentional Falls",
    x = "Year",
    y = "Total TBIs (thousands)"
  )
```

**Observations**:

- Total traumatic brain injuries (TBIs) reported from unintentional falls nearly doubled from 2006 to 2014, while TBIs from people unintentionally struck by or against an object raised somewhat, and TBIs from other injury mechanisms stayed roughly constant. While population did increase, population did not double in this timeframe, so there is still a significant effect here. It is possible that some factor led to more reporting of TBIs, possibly increased awareness among medical professionals.

*Older Adults Most Affected*
- Based on 2014 age group data, traumatic brain injuries from unintentional falls primarily affect adults 75+, with children age 0-4 as the next most impacted group.

```{r falls}
age_summary <-
  tbi_age %>%
  group_by(age_group, injury_mechanism) %>%
  summarize(total = sum(number_est), total_rate = sum(rate_est)) %>%
  filter(total > 0, age_group != "0-17", age_group !="Total")
age_summary$age_group <- 
  factor(
    age_summary$age_group,
    levels = c("0-4","5-14","15-24","25-34","35-44","45-54","55-64","65-74","75+"))
age_summary %>%
  filter(injury_mechanism %in% c("Unintentional Falls")) %>%
  mutate(total = total/1000) %>%
  ggplot() +
  geom_col(
    mapping = aes(x = age_group, y = total),
    position = "dodge") +
  labs(
    title = "TBIs from Unintentional Falls Most Prevalent for Adults 75+",
    x = "Age Group",
    y = "Total TBIs (thousands)"
  )
```

**Observations**:

- Diving deeper into 2014 data, the age group with the highest incidence of unintentional falls are 75+, followed by 0-4. So maybe the increase in unintentional falls is due to older people living longer and thus there being more older people who may have unintentional falls.

*Why So Many More TBIs Reported?*

- This dataset cannot directly answer the question of why so many more truamatic brain injuries for older adults were reported in 2014 than in 2006, but I have some theories. Here I looked into reports by type.

```{r type}
tbi_year %>%
  filter(injury_mechanism != "Total") %>%
  ggplot(mapping = aes(x = year, y = rate_est, color = injury_mechanism, shape = type)) +
  geom_point() +
  geom_line()
```


*TBIs from Unintentional Falls More Fatal for Older Adults*
- While there are many children ages 0-4 with traumatic brain injuries from falls who have emergency department visits or hospitalizations, deaths from traumatic brain injuries from falls is much more commonly reported for the older adults. While for children age 0-4 traumatic brain injuries are most commonly caused by unintentional falls, deaths for children age 0-4 from traumatic brain injury are much more likely to be from assault or motor vehicle crashes.




```{r deaths}
age_summary_deaths <-
  tbi_age %>%
  filter(type == "Deaths") %>%
  filter(number_est > 0, age_group != "0-17", age_group !="Total")
age_summary_deaths$age_group <- 
  factor(
    age_summary_deaths$age_group,
    levels = c("0-4","5-14","15-24","25-34","35-44","45-54","55-64","65-74","75+"))
age_summary_deaths %>%
  ggplot() +
  geom_col(mapping = aes(x = age_group, y = number_est, fill = injury_mechanism), position = "dodge") +
  scale_fill_discrete(name = "Injury Mechanism") +
  labs(
    title = "Older Adult Deaths from TBIs Primarily from Falls",
    x = "Age Group",
    y = "Deaths from TBIs in 2014"
  )
```

**Observations**:

- Unintentional falls for the  75+ age group was also the leading cause of TBI-related deaths in 2014. Intentional self-harm was a distant second for most common cause of deaths, and was significant for all age groups upward of 15 years  old. TBIs from Motor Vehicle Crashes was the third most significant cause of death.
- While looking at number of TBIs from unintentional falls, the 0-4 age group was the second highest age group, deaths from TBIs from unintentional falls was minimal, dwarfed by deaths by assault. Overall deaths from TBIs for the 0-4 age group were very low.


```{r}
age_summary_ed <-
  tbi_age %>%
  filter(type == "Emergency Department Visit") %>%
  filter(number_est > 0, age_group != "0-17", age_group !="Total") %>%
  mutate(thousands = number_est/1000)
age_summary_ed
age_summary_ed$age_group <- 
  factor(
    age_summary_ed$age_group,
    levels = c("0-4","5-14","15-24","25-34","35-44","45-54","55-64","65-74","75+"))
age_summary_ed %>%
  ggplot() +
  geom_col(mapping = aes(x = age_group, y = thousands, fill = injury_mechanism), position = "dodge") +
  scale_fill_discrete(name = "Injury Mechanism") +
  labs(
    title = "Emergency Room Visits Map to the Total",
    x = "Age Group",
    y = "Emergency Room Visits from TBIs in 2014 (thousands)"
  )
```

**Observations**:

- Emergency Room Visits map to the total.

```{r}
age_summary_renamed <-
  age_summary %>%
  mutate(total = total/1000) %>%
  mutate(injury_mechanism = ifelse(
    injury_mechanism == "Unintentionally struck by or against an object", 
    "Unintentional Strike with Object",
    injury_mechanism)) %>%
  mutate(injury_mechanism = ifelse(
    injury_mechanism == "Other unintentional injury, mechanism unspecified", 
    "Other Unintentional Injury",
    injury_mechanism)) %>%
  mutate(injury_mechanism = ifelse(
    injury_mechanism == "Other or no mechanism specified", 
    "Other",
    injury_mechanism)) %>%
  mutate(injury_mechanism = ifelse(
    injury_mechanism == "Intentional self-harm", 
    "Intentional Self-Harm",
    injury_mechanism))
age_summary_renamed
age_summary_renamed$injury_mechanism <- 
  factor(
    age_summary_renamed$injury_mechanism,
    levels = c(
      "Unintentional Falls",
      "Unintentional Strike with Object",
      "Motor Vehicle Crashes",
      "Assault",
      "Other Unintentional Injury",
      "Other",
      "Intentional Self-Harm"))
age_summary_renamed %>%
  ggplot() +
  geom_col(
    mapping = aes(x = age_group, y = total, fill = age_group), 
    position = "dodge") +
  scale_fill_discrete(name = "Age Group") +
  theme(
    axis.title.x =  element_blank(),
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
    ) +
  facet_wrap(~injury_mechanism) +
  labs(
    title = "TBIs from Assault and Car Crashes Most Prevalent for Teens, Young Adults",
    x = "Age Group",
    y = "Total TBIs (thousands)"
  ) 
```

**Observations**:

- While unintentional falls are most common for the age group of 75+ and the second most common age group is 0-4, with the age groups in the middle having the fewest, none of the other causes of TBIs share this pattern. In fact, Motor Vehicle Crashes and Assault share a general pattern of being most common for the age group of 15-24 and the total decreases for each ascending age group.
